from keys import *
import hashlib
import time

def main():
    unit1()
    unit2()
    #unit3()
    unit5()
def unit1():
    start = time.time()
    m = hashlib.sha256()
    m.update(b"3871ba51da8fbdc5f8f269edf48672cdada678e69b8846ca2ea272aaa5b50264610.63621320538209523596475325162826159120566470179699496435869153606275547510132944524201111924683262547348798176878942876234379958444172124096508789730926056814647511709831")
    sk, pk = genkeys()
    m = int(m.hexdigest(), 16)
    sig = sign(sk, m)
    print(verify(pk, sig, m))
    end = time.time()
    print(end - start, 'seconds')


def unit2():
    start = time.time()
    for i in range(1000):
        genkeys()

    end = time.time()
    print(end - start, 'seconds')

def unit3():
    sk, pk = genkeys()
    m = random.getrandbits(8000)
    start = time.time()
    for i in range(1000):
        sig = sign(sk, m)
        verify(pk, sig, m)
    end = time.time()
    print(end - start, 'seconds')


def unit4():
    start = time.time()
    m = hashlib.sha256()
    m.update(b"2681db3c5aa6dbfca65f945b47e2b687293f515fe78e4d0194d515c87679067ef7.6392623268076283348943880985098018607937461552154719794041636503343540464252995170977454460549199628565906226078839142490850863451843340749505203752956149219330280185821")
    sk =5361220944303400159110394709375017849816898953432176824054321222363841846993897107921399442057703185347264153043375143907216081406216351502517417627917739
    pk =15933986000846073426854656792755732051858999531999895123129498265154442671661875732222474347013737233882723372501904327793698352608047077038367612967053333
    m = int(m.hexdigest(), 16)
    sig = sign(sk, m)
    print(verify(pk, sig, m))
    end = time.time()
    print(end - start, 'seconds')
def unit5():

    #sk =
    pkin = 4723874681541778945610269967275748612055866036006055690452870123612284484546411101669236843457868906530095879215735152466359844155876268339166044518260905
    hmin = 65503273040884396567971452040240992095909202055651693092502304957514354712238
    sigin = 8621967494046661496104958740281552398388162260988964643902642581466979475157557116117870881146332853471115640051838318344005342600933537848013982918557928
    #sigGen = sign(sk,hmin)
    #print("siggen:",sigGen)
    #print("siggen = ", sigGen == sigin)
    print(verify(pkin,sigin, hmin))
main()
